스위치

    <p align="center">
    <img src="https://github.com/goodlucky1215/CS_Study/blob/main/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC/tcp_ip%EA%B3%84%EC%B8%B5(5%EA%B3%84%EC%B8%B5)/%EC%82%AC%EC%A7%84/2-1.%20%EC%8A%A4%EC%9C%84%EC%B9%98/switch1.png"
      width="600"
      height="300" />

- 이전 이더넷 네트워크에서는 패킷을 전송할 때 경합해서 통신을 함. => 성능저하 => 스위치는 이런 경쟁이 없음.
- 패킷을 동시에 여러 장비가 서로 간섭 없이 통신하도록 도와주는 장비

1. 동작 방식 3가지  
   (1) 플러딩

- 허브와 같이 모든 포트로 패킷을 흘리는 동작
- 스위치를 부팅하면 처음에는 MAC주소 테이블에 아무런 정보가 없음
- 스위치에 패킷이 들어오면 도착지 MAC주소 확인 => 자신의 MAC주소 테이블에 매칭되는 목적지MAC주소가 없음 => 다른 모든 포트에 같은 내용의 패킷을 전송(플러딩)

(2) 어드레스 러닝

- MAC주소 테이블을 만들고 유지하는 과정을 말함.
- 출발지의 MAC주소와 포트 정보를 MAC주소 테이블에 저장시키는 방법으로 정보를 습득해나간다.

(3) 포워딩/필터링

- 출발지의 패킷이 스위치에 들어온 경우, 도착지 MAC주소를 확인하고 MAC주소 테이블에 맞는 정보가 있으면 해당 포트로 패킷을 포워딩한다. 그러면 나머지 포트들한테는 해당 패킷을 보내지 않으므로 이를 필터링한다고 한다.
- 보통 유니캐스트(1대1통신)에서만 포워딩/필터링이 사용된다.
- 유니캐스트를 플러딩하는 경우는 거의 없다. 왜냐하면 패킷을 만들기 전에 통신해야 하는 단말의 MAC주소를 알아내기 위해 ARP브로드캐스트가 먼저 수행되어야 한다. 이 ARP를 이용한 MAC주소 습득에 의해서 스위치에서는 이미 MAC주소 테이블에 출발지와 목적지의 정보가 채워진다.

2. VLAN

- 물리적인 배치와 상관없이 LAN을 논리적으로 분할, 구성하는 기술이다.
- VLAN으로 분할 시 브로드 캐스트도 할 수가 없어서 L3장비(라우터)가 필요하다.
- 서로 다른 VLAN이 설정 된 포트 간 통신이 안된다. => L3장비(라우터)가 필요하다.

    <p align="center">
    <img src="https://github.com/goodlucky1215/CS_Study/blob/main/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC/tcp_ip%EA%B3%84%EC%B8%B5(5%EA%B3%84%EC%B8%B5)/%EC%82%AC%EC%A7%84/2-1.%20%EC%8A%A4%EC%9C%84%EC%B9%98/MAC%EA%B8%B0%EB%B0%98%20VLAN.png"
      width="600"
      height="300" />

    <p align="center">
    <img src="https://github.com/goodlucky1215/CS_Study/blob/main/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC/tcp_ip%EA%B3%84%EC%B8%B5(5%EA%B3%84%EC%B8%B5)/%EC%82%AC%EC%A7%84/2-1.%20%EC%8A%A4%EC%9C%84%EC%B9%98/%ED%8F%AC%ED%8A%B8%EA%B8%B0%EB%B0%98VLAN.png"
      width="600"
      height="300" />

- VLAN으로 분할 시 서로 다른 네트워크 대역도 같이 묶일 수가 있다.  
  a. MAC기반 VLAN : MAC번호로 VLAN이 할당되어 진다. ex) 다른 곳으로 자리를 옮겨도 VLAN이 똑같이 적용된다.
  b. 포트기반 VLAN : 스위치의 포트에 특정 VLAN을 할당하여 그 스위치 포트에 PC연결을 할 시, 자동으로 그 VLAN을 얻게 되는 것 이다. => 일반적으로 이 VLAN을 의미

[Tagged Port]

- 각 VLAN끼리 연결하려면 또 그 갯수만큼 포트를 연결해야한다. 만약 VLAN이 10, 20, 30이 있다면 각 VLAN이 스위치 간 통신하려면 3개의 포트가 필요하다. => 이러한 낭비를 줄이는 게 **Tagged Port**
- 하나의 포트로 여러개의 VLAN(ex) VLAN이 10, 20, 30)을 함께 전송할 수 있게 한다.

https://ja-gamma.tistory.com/entry/VLAN-Taguntag%EA%B0%9C%EB%85%90%EC%B0%A8%EC%9D%B4%EC%A0%90

[STP]

- SPoF(Single Point of Failure) : 하나의 시스템이나 구성 요소에 고장이 발생하면 전체 시스템의 작동이 멈추는 것 => 이걸 피하기 위해 스위치 두 대로 디자인
- 네트워크 루프 : 스위치 두 대 이상으로 디자인 하면 패킷이 네트워크를 따라 전송하므로 루프를 돌아서 네트워크가 마비되어 통신이 안 되는 것을 의미. => 대부분 브로드캐스트 스톰 문제
  (1) 브로드캐스트 스톰 : 루프 구조로 연결된 네트워크 => 브로드캐스트 발생 => A스위치는 패킷이 유입된 포트를 제외하고 모든 포트로 플러딩 => 플러딩 된 패킷은 다른 B스위치로 보내짐 => 이 패킷을 받은 B스위치가 또 다시 플러딩 => 그리고 또 다시 A스위치로 가서 플러딩 => 또 다시 B스위치로 가서 플러딩 => 무한 반복 (패킷이 3계층과 같은 TTL이 없어서 죽지 않고 계속 살아남아 있다.) => 네트워크 마비가 됨.
  (2) MAC어드레스 플래핑 : 패킷 A스위치로 전달 => A스위치에서 출발지MAC주소와 포트(1)를 B스위치, C스위치에 전달 => B스위치는 출발지MAC주소와 포트(2)를 C스위치에 전달 => C스위치는 A스위치와 B스위치가 준 출발지MAC주소의 포트(1과 2로)가 다름(이게 MAC어드레스 플래핑)
  -> 스패닝 트리 프로토콜(STP)로 문제 해결.
  - STP(스패닝 트리 프로토콜) : 평소에 스위치를 여러개 구성하더라도 스위치 루프를 도는 포트 하나를 차단해둔다. 그리고 장애가 발생하면 차단된 포트를 스위치 스스로 풀어주는 방식이다. => 루프가 생기지 않도록 하는 것이 목적
    => 과정 : 새로운 스위치가 연결 => 루프를 예방하기 위해서 스위치가 어떻게 연결되어있는지 알아야 함. => 패킷 전송들은 전부 차단, BPDU프로토콜을 통해 스위치 간에 정보를 전달(Blocking) => 정보를 받은 스위치도 자신의 정보를 전달함(Listening) => 이 정보를 이용해 네트워크 트리를 만들어 루프 구간 확인 하고 새로 들어온 스위치가 패킷 포워딩을 해도 되는지 결정(Learning) => 패킷 포워딩이 가능하면 통신을 해도 되고(Forwarding), 루프 지점이라면 차단해 루프 예방
